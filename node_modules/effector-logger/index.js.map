{"version":3,"file":"index.js","sources":["../src/lib.ts","../src/logger.ts","../src/redux-devtools.ts","../src/attach.ts","../src/index.ts"],"sourcesContent":["import {\n  createNode,\n  is,\n  step,\n  Domain,\n  Scope,\n  CompositeName,\n  Unit, Node,\n} from 'effector';\n\nexport const LOGGER_DOMAIN_NAME = '@effector-logger';\n\nexport function createName(composite: CompositeName): string {\n  return composite.path.filter((name) => name !== LOGGER_DOMAIN_NAME).join('/');\n}\n\nexport function getPath(unit: Unit<any>): string {\n  return (unit as any).defaultConfig?.loc?.file ?? ' ';\n}\n\nfunction watchDomain(\n  unit: Unit<any>,\n  domain: Domain,\n  fn: (payload: any) => any,\n): void {\n  if (is.store(unit)) {\n    fn(unit.getState());\n  }\n  const watchUnit = is.store(unit) ? unit.updates : unit;\n  (watchUnit as any).watch(fn);\n}\n\nfunction watchScope(\n  unit: Unit<any>,\n  scope: Scope,\n  fn: (payload: any) => any,\n): void {\n  if (is.store(unit)) {\n    fn(scope.getState(unit));\n  }\n  const node = createNode({\n    node: [step.run({ fn })]\n  });\n  const watchUnit = is.store(unit) ? unit.updates : unit;\n  const id = (watchUnit as any).graphite.id;\n  const links: Node[] = ((scope as any).additionalLinks[id] =\n    (scope as any).additionalLinks[id] || []);\n  links.push(node);\n}\n\nexport function watch(\n  unit: Unit<any>,\n  source: Domain | Scope,\n  fn: (payload: any) => any,\n): void {\n  if (is.domain(source)) {\n    watchDomain(unit, source, fn);\n  } else {\n    watchScope(unit, source, fn);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport debounce from 'just-debounce-it';\nimport isNode from 'detect-node';\nimport { Effect, Event, Store } from 'effector';\nimport { createName, getPath } from './lib';\n\nconst SEPARATOR = isNode ? '  ' : '';\n\nconst storeListToInit: Array<Store<any>> = [];\nconst eventListToInit: Array<Event<any>> = [];\nconst effectListToInit: Array<Effect<any, any, any>> = [];\n\nconst styles = {\n  block: 'padding-left: 4px; padding-right: 4px; font-weight: normal;',\n  chunk: 'padding-left: 4px; padding-right: 4px; font-weight: normal;',\n  effector:\n    'line-height:1.5; color: #000; font-family: \"Apple Emoji Font\"; font-weight: normal !important;',\n  new: 'background-color: #29b6f6; color: #000',\n  store: 'background-color: #7e57c2; color: #fff',\n  event: 'background-color: #9ccc65; color: #000',\n  effect: 'background-color: #26a69a; color: #000',\n  emoji: '',\n  file: 'color: #9e9e9e; padding-left: 20px;',\n  reset: 'color: currentColor; background-color: transparent;',\n};\n\nconst effectorLabel: Block[] = [\n  ['☄️', '%s', styles.effector],\n  ['effector', '%s', 'font-family: Menlo, monospace;']\n];\n\nconst reset = (index: number, count: number, style: string): string =>\n  index === count - 1 ? styles.reset : style;\n\ntype Block = [string, string, string];\ntype Chunk = [any, string, string];\n\nfunction log(\n  blocks: Block[],\n  chunks: Chunk[],\n  group: 'collapsed' | 'open' | void = undefined,\n): void {\n  const str: string[] = [];\n  const params: any[] = [];\n\n  blocks.unshift(...effectorLabel);\n\n  blocks.forEach(([value, view, style], index) => {\n    str.push(`%c${view}%c`);\n    params.push(\n      `${styles.block} ${style}`,\n      value,\n      reset(index, blocks.length, `${styles.block} ${style}`),\n    );\n  });\n\n  chunks.forEach(([value, view, style]) => {\n    str.push(`%c${view}`);\n    params.push(`${styles.chunk} ${style}`, value);\n  });\n\n  const args = [str.join(SEPARATOR), ...params];\n\n  if (group === 'open') {\n    console.group(...args);\n  } else if (group === 'collapsed') {\n    console.groupCollapsed(...args);\n  } else {\n    console.log(...args);\n  }\n}\n\nconst blockNew: Block = ['new', '%s', styles.new];\n\nconst blockStore: Block = ['store', '%s', styles.store];\nconst blockEvent: Block = ['event', '%s', styles.event];\nconst blockEffect: Block = ['effect', '%s', styles.effect];\n\nconst stripDomain = (name: string) => name.split('/').pop() || name;\n\nconst createBlockStore: (name: string) => Block = (name) => [stripDomain(name), '%s', styles.store];\nconst createBlockEvent: (name: string) => Block =  (name) => [stripDomain(name), '%s', styles.event];\nconst createBlockEffect: (name: string) => Block = (name) => [stripDomain(name), '%s', styles.effect];\n\nconst logAdded = debounce(() => {\n  const stores = storeListToInit.splice(0);\n  const events = eventListToInit.splice(0);\n  const effects = effectListToInit.splice(0);\n\n  if (stores.length + events.length + effects.length > 0) {\n    log(\n      [blockNew],\n      [\n        ['Initialized', '%s', ''],\n        [`events(${events.length})`, '%s', ''],\n        [`effects(${effects.length})`, '%s', ''],\n        [`stores(${stores.length})`, '%s', ''],\n      ],\n      'collapsed',\n    );\n\n    if (stores.length) {\n      stores.forEach((store) => {\n        const name = createName(store.compositeName);\n        const fileName = getPath(store);\n\n        log(\n          [blockNew, createBlockStore(name)],\n          [\n            ['-> ', '%s', ''],\n            [store.getState(), '%o', ''],\n            [fileName, '%s', styles.file],\n            [name, '%s', ''],\n          ],\n        );\n      });\n    }\n    if (events.length > 0) {\n      events.forEach((event) => {\n        const name = createName(event.compositeName);\n        const fileName = getPath(event);\n\n        log(\n          [blockNew, createBlockEvent(name)],\n          [\n            [fileName, '%s', styles.file],\n            [name, '%s', ''],\n          ],\n        );\n      });\n    }\n    if (effects.length > 0) {\n      effects.forEach((effect) => {\n        const name = createName(effect.compositeName);\n        const fileName = getPath(effect);\n\n        log(\n          [blockNew, createBlockEffect(name)],\n          [\n            [fileName, '%s', styles.file],\n            [name, '%s', ''],\n          ],\n        );\n      });\n    }\n    console.groupEnd();\n  }\n}, 5);\n\nexport function storeAdded(store: Store<any>): void {\n  storeListToInit.push(store);\n  logAdded();\n}\n\nexport function eventAdded(event: Event<any>): void {\n  eventListToInit.push(event);\n  logAdded();\n}\n\nexport function effectAdded(effect: Effect<any, any, any>): void {\n  effectListToInit.push(effect);\n  logAdded();\n}\n\nexport function storeUpdated(name: string, fileName: string, value: any): void {\n  log(\n    [createBlockStore(name)],\n    [\n      ['-> ', '%s', ''],\n      [value, '%o', ''],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n  );\n}\n\nexport function eventCalled(\n  name: string,\n  fileName: string,\n  payload: any,\n): void {\n  log(\n    [createBlockEvent(name)],\n    [\n      [payload, '%o', 'padding-left: 4px;'],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n  );\n}\n\nexport function effectCalled(\n  name: string,\n  fileName: string,\n  parameters: any,\n): void {\n  log(\n    [createBlockEffect(name)],\n    [\n      [parameters, '%o', 'padding-left: 4px;'],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n  );\n}\n\nexport function effectDone(\n  name: string,\n  fileName: string,\n  parameters: any,\n  result: any,\n): void {\n  log(\n    [createBlockEffect(name)],\n    [\n      ['done ✅', '%s', styles.emoji],\n      [parameters, '(%o)', 'padding-left: 4px;'],\n      ['-> ', '%s', ''],\n      [result, '%o', 'padding: 0;'],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n  );\n}\n\nexport function effectFail(\n  name: string,\n  fileName: string,\n  parameters: any,\n  error: any,\n): void {\n  const instanceofError = error instanceof Error;\n\n  log(\n    [createBlockEffect(name)],\n    [\n      ['fail ❌', '%s', styles.emoji],\n      [parameters, '(%o)', 'padding-left: 4px;'],\n      ['-> ', '%s', ''],\n      instanceofError\n        ? [String(error), '%s', '']\n        : [error, '%o', 'padding: 0;'],\n      [fileName, '%s', styles.file],\n      [name, '%s', styles.file],\n    ],\n    instanceofError ? 'collapsed' : undefined,\n  );\n\n  if (instanceofError) {\n    log(\n      [],\n      [\n        [' ', '%s', ''],\n        [error, '%o', 'padding-left: 20px;'],\n      ],\n    );\n  }\n\n  console.groupEnd();\n}\n","import * as effector from 'effector';\nimport set from 'set-value';\nimport { createName } from './lib';\n\n/* eslint-disable @typescript-eslint/ban-ts-ignore, @typescript-eslint/no-explicit-any */\nconst reduxDevTools =\n  // @ts-ignore\n  typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__;\n\nfunction instanceId(): string {\n  if (typeof document === 'object') {\n    return `☄️ ${document.title}`\n  }\n  return '☄️ no title instance'\n}\n\nconst devToolConfig = {\n  instanceId: instanceId(),\n} as unknown as { swallowErrors?: boolean };\n\nconst rootState: Record<string, any> = {};\n\nfunction setState(name: string, value: any): void {\n  set(rootState, name.replace(/\\//g, '.'), value);\n}\n\nexport function eventCalled(name: string, payload: any): void {\n  if (reduxDevTools) {\n    reduxDevTools.send({\n        type: `${name} (event)`,\n        payload,\n      },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n\nexport function storeAdded(store: effector.Store<any>): void {\n  const name = createName(store.compositeName);\n\n  setState(name, store.defaultState);\n}\n\nexport function storeUpdated(name: string, value: any): void {\n  setState(name, value);\n\n  if (reduxDevTools) {\n    reduxDevTools.send({\n        type: `${name} (store updated)`,\n        value,\n      },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n\ntype Effect = effector.Effect<any, any, any>;\n\nfunction effectUpdateState(name: string, effect: Effect): void {\n  setState(name, {\n    inFlight: effect.inFlight.getState(),\n    pending: effect.pending.getState(),\n  });\n}\n\nexport function effectAdded(name: string, effect: Effect): void {\n  effectUpdateState(name, effect);\n}\n\nexport function effectCalled(\n  name: string,\n  effect: Effect,\n  parameters: any,\n): void {\n  effectUpdateState(name, effect);\n\n  if (reduxDevTools) {\n    reduxDevTools.send(\n      { type: `${name} (effect called)`, params: parameters },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n\nexport function effectDone(\n  name: string,\n  effect: Effect,\n  parameters: any,\n  result: any,\n): void {\n  effectUpdateState(name, effect);\n\n  if (reduxDevTools) {\n    reduxDevTools.send(\n      { type: `${name}.done (effect finished)`, params: parameters, result },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n\nexport function effectFail(\n  name: string,\n  effect: Effect,\n  parameters: any,\n  error: any,\n): void {\n  effectUpdateState(name, effect);\n\n  if (reduxDevTools) {\n    reduxDevTools.send(\n      { type: `${name}.fail (effect finished)`, params: parameters, error },\n      rootState,\n      devToolConfig,\n    );\n  }\n}\n","/**\n * This is an another entry point for webpack.\n * Be careful with BREAKING CHANGES in this file.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any, @typescript-eslint/unbound-method */\nimport { Domain, is, Scope, Store, Event, Effect } from 'effector';\nimport * as inspector from 'effector-inspector';\n\nimport { createName, getPath, watch } from './lib';\nimport * as consoleLogger from './logger';\nimport * as devtools from './redux-devtools';\n\nexport { LOGGER_DOMAIN_NAME } from './lib';\n\ntype Options = {\n  reduxDevtools: 'enabled' | 'disabled';\n  console: 'enabled' | 'disabled';\n  inspector: 'enabled' | 'disabled';\n};\n\nconst defaults: Options = {\n  reduxDevtools: 'enabled',\n  console: 'enabled',\n  inspector: 'enabled',\n};\n\ninterface ConfigureOptions {\n  log: 'enabled' | 'disabled';\n}\n\ninterface UnitLogger {\n  'effector-logger': ConfigureOptions;\n}\n\nconst defaultConfigure = (): ConfigureOptions => ({ log: 'enabled' });\n\ntype Unit = Store<any> | Event<any> | Effect<any, any, any>;\n\nfunction withConfig(unit: Unit, partial?: Partial<ConfigureOptions>): typeof unit & UnitLogger {\n  const source = unit as unknown as UnitLogger & typeof unit;\n  if (!source['effector-logger']) {\n    source['effector-logger'] = defaultConfigure();\n  }\n\n  if (partial) {\n    source['effector-logger'] = {\n      ...source['effector-logger'],\n      ...partial,\n    };\n  }\n  return source;\n}\n\nexport function configure(unit: Array<Unit> | Unit, config?: Partial<ConfigureOptions>): void {\n  if (Array.isArray(unit)) {\n    unit.forEach((unit) => withConfig(unit, config));\n    return;\n  }\n  withConfig(unit, config);\n}\n\nfunction shouldLog(unit: Event<any> | Store<any> | Effect<any, any>): boolean {\n  return withConfig(unit)['effector-logger'].log === 'enabled';\n}\n\nexport function attachLogger(source: Domain | Scope, logTo: Partial<Options> = {}): void {\n  const options = { ...defaults, ...logTo };\n  const isConsole = options.console === 'enabled';\n  const isRedux = options.reduxDevtools === 'enabled';\n  const isInspector = options.inspector === 'enabled';\n\n  function attachEvent(event: Event<any>): void {\n    const name = createName(event.compositeName);\n    const fileName = getPath(event);\n\n    if (isConsole) consoleLogger.eventAdded(event);\n    if (isInspector) inspector.addEvent(event);\n\n    watch(event, source, (payload) => {\n      if (shouldLog(event)) {\n        if (isConsole) consoleLogger.eventCalled(name, fileName, payload);\n        if (isRedux) devtools.eventCalled(name, payload);\n      }\n    });\n  }\n\n  function attachStore(store: Store<any>): void {\n    const name = createName(store.compositeName);\n    const fileName = getPath(store);\n\n    if (isConsole) consoleLogger.storeAdded(store);\n    if (isRedux) devtools.storeAdded(store);\n    if (isInspector) inspector.addStore(store);\n\n    const storeMap = store.map.bind(store);\n\n    store.map = (fn: any, firstState?: any): Store<any> => {\n      const mappedStore = storeMap(fn, firstState);\n\n      mappedStore.compositeName.path = store.compositeName.path.slice(0, -1);\n      mappedStore.compositeName.path.push(store.compositeName.path.slice(-1) + ' -> *');\n      if (isInspector) inspector.addStore(mappedStore, { mapped: true });\n      return mappedStore;\n    };\n\n    watch(store, source, (value) => {\n      if (shouldLog(store)) {\n        if (isConsole) consoleLogger.storeUpdated(name, fileName, value);\n        if (isRedux) devtools.storeUpdated(name, value);\n      }\n    });\n  }\n\n  function attachEffect(effect: Effect<any, any, any>): void {\n    const name = createName(effect.compositeName);\n    const fileName = getPath(effect);\n\n    if (isConsole) consoleLogger.effectAdded(effect);\n    if (isRedux) devtools.effectAdded(name, effect);\n    if (isInspector) inspector.addEffect(effect);\n\n    watch(effect, source, (parameters) => {\n      if (shouldLog(effect)) {\n        if (isConsole) consoleLogger.effectCalled(name, fileName, parameters);\n        if (isRedux) devtools.effectCalled(name, effect, parameters);\n      }\n    });\n\n    watch(effect.done, source, ({ params, result }) => {\n      if (shouldLog(effect)) {\n        if (isConsole) consoleLogger.effectDone(name, fileName, params, result);\n        if (isRedux) devtools.effectDone(name, effect, params, result);\n      }\n    });\n\n    watch(effect.fail, source, ({ params, error }) => {\n      if (shouldLog(effect)) {\n        if (isConsole) consoleLogger.effectFail(name, fileName, params, error);\n        if (isRedux) devtools.effectFail(name, effect, params, error);\n      }\n    });\n  }\n\n  if (is.domain(source)) {\n    source.onCreateEvent(attachEvent);\n    source.onCreateStore(attachStore);\n    source.onCreateEffect(attachEffect);\n  } else {\n    const root = (source as any).cloneOf;\n    if (root === undefined) {\n      throw new Error('Scope should be created from domain');\n    }\n    for (const event of root.history.events) {\n      attachEvent(event);\n    }\n    for (const effect of root.history.effects) {\n      attachEffect(effect);\n    }\n    for (const store of root.history.stores) {\n      attachStore(store);\n    }\n  }\n}\n","import * as effector from 'effector';\nimport { attachLogger, configure } from './attach';\nimport { LOGGER_DOMAIN_NAME } from './lib';\n\nconst root = effector.createDomain(LOGGER_DOMAIN_NAME);\n\nattachLogger(root);\n\nconst { createDomain, createStore, createEffect, createEvent } = root;\n\nexport { createDomain, createStore, createEffect, createEvent, configure };\nexport * from 'effector';\n"],"names":["LOGGER_DOMAIN_NAME","createName","composite","path","filter","name","join","getPath","unit","defaultConfig","loc","file","watchDomain","domain","fn","is","store","getState","watchUnit","updates","watch","watchScope","scope","node","createNode","step","run","id","graphite","links","additionalLinks","push","source","SEPARATOR","isNode","storeListToInit","eventListToInit","effectListToInit","styles","block","chunk","effector","new","event","effect","emoji","reset","effectorLabel","index","count","style","log","blocks","chunks","group","undefined","str","params","unshift","forEach","value","view","length","args","console","groupCollapsed","blockNew","stripDomain","split","pop","createBlockStore","createBlockEvent","createBlockEffect","logAdded","debounce","stores","splice","events","effects","compositeName","fileName","groupEnd","storeAdded","eventAdded","effectAdded","storeUpdated","eventCalled","payload","effectCalled","parameters","effectDone","result","effectFail","error","instanceofError","Error","String","reduxDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","instanceId","document","title","devToolConfig","rootState","setState","set","replace","send","type","defaultState","effectUpdateState","inFlight","pending","defaults","reduxDevtools","inspector","defaultConfigure","withConfig","partial","configure","config","Array","isArray","shouldLog","attachLogger","logTo","options","isConsole","isRedux","isInspector","attachEvent","consoleLogger","addEvent","devtools","attachStore","addStore","storeMap","map","bind","firstState","mappedStore","slice","mapped","attachEffect","addEffect","done","fail","onCreateEvent","onCreateStore","onCreateEffect","root","cloneOf","history","createDomain","createStore","createEffect","createEvent"],"mappings":"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"}